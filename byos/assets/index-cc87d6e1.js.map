{"version":3,"file":"index-cc87d6e1.js","sources":["../../raw_code/byos/src/script.js"],"sourcesContent":["var id = document.getElementById(\"drawflow\");\r\nconst editor = new Drawflow(id);\r\nvar audioContext = new (window.AudioContext || window.webkitAudioContext)();\r\neditor.reroute = true;\r\neditor.start();\r\n\r\n// Events!\r\nconst audioNodes = new Map();\r\nconst stateString = \"synth\";\r\n\r\nasync function compress(str) {\r\n  // Convert the string to a byte stream.\r\n  const stream = new Blob([str]).stream();\r\n\r\n  // Create a compressed stream.\r\n  const compressedStream = stream.pipeThrough(new CompressionStream(\"gzip\"));\r\n\r\n  // Read all the bytes from this stream.\r\n  const chunks = [];\r\n  for await (const chunk of compressedStream) {\r\n    chunks.push(chunk);\r\n  }\r\n  return await concatUint8Arrays(chunks);\r\n}\r\n\r\nasync function decompress(compressedBytes) {\r\n  // Convert the bytes to a stream.\r\n  const stream = new Blob([compressedBytes]).stream();\r\n\r\n  // Create a decompressed stream.\r\n  const decompressedStream = stream.pipeThrough(\r\n    new DecompressionStream(\"gzip\")\r\n  );\r\n\r\n  // Read all the bytes from this stream.\r\n  const chunks = [];\r\n  for await (const chunk of decompressedStream) {\r\n    chunks.push(chunk);\r\n  }\r\n  const stringBytes = await concatUint8Arrays(chunks);\r\n\r\n  // Convert the bytes to a string.\r\n  return new TextDecoder().decode(stringBytes);\r\n}\r\n\r\nasync function concatUint8Arrays(uint8arrays) {\r\n  const blob = new Blob(uint8arrays);\r\n  const buffer = await blob.arrayBuffer();\r\n  return new Uint8Array(buffer);\r\n}\r\n\r\nasync function encodeToUrl(data) {\r\n  const dataString = JSON.stringify(data);\r\n  compress(dataString).then((uint8Array) => {\r\n    const base64 = btoa(String.fromCharCode.apply(null, uint8Array));\r\n    const base64UrlSafe = base64.replace(/\\+/g, \"-\").replace(/\\//g, \"_\");\r\n    const url = new URL(window.location.href);\r\n    url.searchParams.set(\"d\", base64UrlSafe);\r\n    window.history.pushState(null, \"\", url.toString());\r\n  });\r\n}\r\n\r\nasync function decodeFromUrl() {\r\n  const urlParams = new URLSearchParams(window.location.search);\r\n  const base64UrlSafe = urlParams.get(\"d\");\r\n  if (!base64UrlSafe) {\r\n    return null;\r\n  }\r\n  let base64 = base64UrlSafe.replace(/-/g, \"+\").replace(/_/g, \"/\");\r\n  let uint8Array = new Uint8Array(\r\n    atob(base64)\r\n      .split(\"\")\r\n      .map((char) => char.charCodeAt(0))\r\n  );\r\n  return decompress(uint8Array).then((str) => {\r\n    return str;\r\n  });\r\n}\r\n\r\nasync function readData() {\r\n  const urlData = await decodeFromUrl();\r\n  const state = urlData ?? localStorage.getItem(stateString);\r\n  if (state && state != \"undefined\") {\r\n    const { data } = JSON.parse(state).drawflow.Home;\r\n\r\n    const connectionsMap = {};\r\n    const idMap = {};\r\n\r\n    for (const [_, value] of Object.entries(data)) {\r\n      const { id, name, data, html, inputs, outputs, pos_x, pos_y } = value;\r\n\r\n      console.log(\r\n        value,\r\n        Object.keys(inputs).length,\r\n        Object.keys(outputs).length\r\n      );\r\n      const newId = editor.addNode(\r\n        name,\r\n        Object.keys(inputs).length,\r\n        Object.keys(outputs).length,\r\n        pos_x,\r\n        pos_y,\r\n        value.class,\r\n        data,\r\n        html\r\n      );\r\n\r\n      audioNodes[newId].updateData(data);\r\n\r\n      idMap[id] = newId;\r\n      connectionsMap[newId] = {};\r\n      for (const [outputName, value] of Object.entries(outputs)) {\r\n        connectionsMap[newId][outputName] = [];\r\n        for (let i = 0; i < value.connections.length; i++) {\r\n          connectionsMap[newId][outputName].push(value.connections[i]);\r\n        }\r\n      }\r\n    }\r\n\r\n    for (const [newId, connections] of Object.entries(connectionsMap)) {\r\n      for (const [outputName, connectionList] of Object.entries(connections)) {\r\n        for (let i = 0; i < connectionList.length; i++) {\r\n          const { node, output } = connectionList[i];\r\n          editor.addConnection(newId, idMap[node], outputName, output);\r\n        }\r\n      }\r\n    }\r\n  }\r\n  await encodeToUrl(editor.export());\r\n}\r\n\r\nasync function saveData() {\r\n  const data = editor.export();\r\n  localStorage.setItem(stateString, JSON.stringify(data));\r\n  await encodeToUrl(data);\r\n}\r\n\r\nvar exportdata = editor.export();\r\neditor.import(exportdata);\r\n\r\nfunction draw() {\r\n  audioContext.resume();\r\n  const timestamp = Date.now();\r\n  for (const [_, audioNode] of Object.entries(audioNodes)) {\r\n    const canvas = audioNode.canvas;\r\n    const analyser = audioNode.analyser;\r\n    if (canvas && analyser) {\r\n      const canvasCtx = canvas.getContext(\"2d\");\r\n      const bufferLength = analyser.frequencyBinCount;\r\n      const dataArray = new Uint8Array(bufferLength);\r\n      analyser.getByteTimeDomainData(dataArray);\r\n\r\n      audioNode.history.push([timestamp, dataArray]);\r\n\r\n      const windowSize = 500;\r\n\r\n      audioNode.history = audioNode.history.filter(\r\n        ([time, _]) => time > timestamp - windowSize\r\n      );\r\n\r\n      const bufferTimeLength =\r\n        (1000 * analyser.frequencyBinCount) / audioContext.sampleRate;\r\n      const sampleTick = bufferTimeLength / analyser.frequencyBinCount;\r\n\r\n      canvasCtx.clearRect(0, 0, canvas.width, canvas.height);\r\n      canvasCtx.fillStyle = \"rgb(200 200 200)\";\r\n      canvasCtx.fillRect(0, 0, canvas.width, canvas.height);\r\n      canvasCtx.lineWidth = 2;\r\n      canvasCtx.strokeStyle = \"rgb(0 0 0)\";\r\n      canvasCtx.beginPath();\r\n      let x = 0;\r\n      let time = audioNode.history[0][0] - bufferTimeLength;\r\n      for (let i = 0; i < audioNode.history.length; i++) {\r\n        const data = audioNode.history[i][1];\r\n\r\n        for (let j = 0; j < data.length; j++) {\r\n          const v = data[j] / 128.0;\r\n          const y = v * (canvas.height / 2);\r\n\r\n          if (i === 0 && j == 0) {\r\n            canvasCtx.moveTo(canvas.width * x, y);\r\n          } else {\r\n            canvasCtx.lineTo(canvas.width * x, y);\r\n          }\r\n\r\n          x += sampleTick / windowSize;\r\n          time += sampleTick;\r\n          if (time > audioNode.history?.[i + 1]?.[0] - bufferTimeLength) {\r\n            break;\r\n          }\r\n        }\r\n      }\r\n      canvasCtx.stroke();\r\n    }\r\n  }\r\n\r\n  requestAnimationFrame(draw);\r\n}\r\n\r\neditor.on(\"nodeCreated\", function (id) {\r\n  const node = editor.getNodeFromId(id);\r\n\r\n  switch (node.class) {\r\n    case \"oscillator\":\r\n      audioNodes[id] = audioContext.createOscillator();\r\n      audioNodes[id].start();\r\n      break;\r\n    case \"output\":\r\n      audioNodes[id] = audioContext;\r\n      break;\r\n    case \"gain\":\r\n      audioNodes[id] = audioContext.createGain();\r\n      break;\r\n    case \"envelope\":\r\n      audioNodes[id] = new Envelope();\r\n      break;\r\n    case \"filter\":\r\n      audioNodes[id] = audioContext.createBiquadFilter();\r\n      break;\r\n    case \"noise\":\r\n      audioNodes[id] = new NoiseNode();\r\n      break;\r\n    default:\r\n      break;\r\n  }\r\n\r\n  switch (node.class) {\r\n    case \"oscillator\":\r\n    case \"gain\":\r\n    case \"envelope\":\r\n    case \"filter\":\r\n    case \"noise\":\r\n      const htmlBody = document\r\n        .getElementById(`node-${id}`)\r\n        .getElementsByClassName(\"drawflow_content_node\")[0].children[0];\r\n      const canvas = document.createElement(\"canvas\");\r\n      canvas.width = 180;\r\n      canvas.height = 180;\r\n      htmlBody.appendChild(canvas);\r\n      const analyser = audioContext.createAnalyser();\r\n      analyser.fftSize = 2048;\r\n      const bufferLength = analyser.frequencyBinCount;\r\n      const dataArray = new Uint8Array(bufferLength);\r\n      analyser.getByteTimeDomainData(dataArray);\r\n\r\n      audioNodes[id].connect(analyser);\r\n\r\n      audioNodes[id].canvas = canvas;\r\n      audioNodes[id].analyser = analyser;\r\n      audioNodes[id].history = [];\r\n    default:\r\n      break;\r\n  }\r\n  saveData();\r\n});\r\n\r\neditor.on(\"nodeRemoved\", function (id) {\r\n  saveData();\r\n  // remove connections\r\n});\r\n\r\neditor.on(\"nodeSelected\", function (id) {});\r\n\r\neditor.on(\"moduleCreated\", function (name) {});\r\n\r\neditor.on(\"moduleChanged\", function (name) {});\r\n\r\nconsole.log(\"sample rate\", audioContext.sampleRate);\r\nclass NoiseNode extends AudioBufferSourceNode {\r\n  constructor() {\r\n    super(audioContext);\r\n    const bufferSize = 2 * audioContext.sampleRate;\r\n    const noiseBuffer = audioContext.createBuffer(\r\n      1,\r\n      bufferSize,\r\n      audioContext.sampleRate\r\n    );\r\n\r\n    this.type = \"white\";\r\n    this.buffer = noiseBuffer;\r\n    this.loop = true;\r\n\r\n    this.regenerateBuffer();\r\n    this.start(0);\r\n  }\r\n\r\n  regenerateBuffer() {\r\n    // https://noisehack.com/generate-noise-web-audio-api/\r\n    const output = this.buffer.getChannelData(0);\r\n    const bufferSize = 2 * audioContext.sampleRate;\r\n    switch (this.type) {\r\n      case \"pink\":\r\n        var b0, b1, b2, b3, b4, b5, b6;\r\n        b0 = b1 = b2 = b3 = b4 = b5 = b6 = 0.0;\r\n        for (var i = 0; i < bufferSize; i++) {\r\n          const white = Math.random() * 2 - 1;\r\n          b0 = 0.99886 * b0 + white * 0.0555179;\r\n          b1 = 0.99332 * b1 + white * 0.0750759;\r\n          b2 = 0.969 * b2 + white * 0.153852;\r\n          b3 = 0.8665 * b3 + white * 0.3104856;\r\n          b4 = 0.55 * b4 + white * 0.5329522;\r\n          b5 = -0.7616 * b5 - white * 0.016898;\r\n          output[i] = b0 + b1 + b2 + b3 + b4 + b5 + b6 + white * 0.5362;\r\n          output[i] *= 0.11; // (roughly) compensate for gain\r\n          b6 = white * 0.115926;\r\n        }\r\n        break;\r\n      case \"brown\":\r\n        var lastOut = 0;\r\n        for (var i = 0; i < bufferSize; i++) {\r\n          var white = Math.random() * 2 - 1;\r\n          output[i] = (lastOut + 0.02 * white) / 1.02;\r\n          lastOut = output[i];\r\n          output[i] *= 3.5; // (roughly) compensate for gain\r\n        }\r\n        break;\r\n      case \"white\":\r\n      default:\r\n        for (var i = 0; i < bufferSize; i++) {\r\n          output[i] = Math.random() * 2 - 1;\r\n        }\r\n        break;\r\n    }\r\n    this.buffer = this.buffer;\r\n  }\r\n\r\n  getInput(key) {\r\n    return this;\r\n  }\r\n\r\n  updateData(data) {\r\n    if (this.type != data.type) {\r\n      this.type = data.type;\r\n      this.regenerateBuffer();\r\n    }\r\n  }\r\n}\r\n\r\nclass Envelope extends GainNode {\r\n  constructor() {\r\n    super(audioContext);\r\n    this.constantNode = audioContext.createConstantSource();\r\n    this.constantNode.connect(this);\r\n    this.constantNode.start();\r\n    this.data = {\r\n      ramptype: \"exp\",\r\n      peak: 1,\r\n      attack: 1,\r\n      decay: 1,\r\n    };\r\n  }\r\n\r\n  applyEnvelope() {\r\n    var setValue;\r\n    var currentTime = audioContext.currentTime;\r\n    console.log(this.data);\r\n    this.gain.cancelScheduledValues(currentTime);\r\n    switch (this.data.ramptype) {\r\n      case \"linear\":\r\n        setValue = (val, t) => this.gain.linearRampToValueAtTime(val, t);\r\n        break;\r\n      case \"instant\":\r\n        setValue = (val, t) => this.gain.setValueAtTime(val, t);\r\n        break;\r\n      default:\r\n      case \"exp\":\r\n        setValue = (val, t) => this.gain.exponentialRampToValueAtTime(val, t);\r\n        break;\r\n    }\r\n    const addStep = (val, deltaTime) => {\r\n      if (deltaTime > 0) {\r\n        currentTime += deltaTime;\r\n        setValue(val, currentTime);\r\n      }\r\n    };\r\n    if (this.data.attack > 0) {\r\n      this.gain.setValueAtTime(0.001, currentTime);\r\n    }\r\n\r\n    addStep(this.data.peak, this.data.attack);\r\n    addStep(0.001, this.data.decay);\r\n  }\r\n\r\n  getInput(key) {\r\n    return this;\r\n  }\r\n\r\n  updateData(data) {\r\n    this.data.ramptype = data.ramptype;\r\n    this.data.peak = Number(data.peak);\r\n    this.data.attack = Number(data.attack);\r\n    this.data.decay = Number(data.decay);\r\n    this.applyEnvelope();\r\n  }\r\n}\r\n\r\nBiquadFilterNode.prototype.getInput = function (key) {\r\n  switch (key) {\r\n    case \"input_1\":\r\n      return this;\r\n    case \"input_2\":\r\n    default:\r\n      return this.frequency;\r\n  }\r\n};\r\n\r\nAudioContext.prototype.getInput = function (key) {\r\n  switch (key) {\r\n    default:\r\n      return this.destination;\r\n  }\r\n};\r\n\r\nGainNode.prototype.getInput = function (key) {\r\n  switch (key) {\r\n    case \"input_1\":\r\n      return this;\r\n    case \"input_2\":\r\n    default:\r\n      return this.gain;\r\n  }\r\n};\r\n\r\nOscillatorNode.prototype.getInput = function (key) {\r\n  switch (key) {\r\n    default:\r\n      return this.frequency;\r\n  }\r\n};\r\n\r\nAudioContext.prototype.updateData = () => {};\r\nOscillatorNode.prototype.updateData = function (data) {\r\n  this.type = data.type;\r\n  this.frequency.value = data.frequency;\r\n};\r\nGainNode.prototype.updateData = function (data) {\r\n  this.gain.value = data.gain;\r\n};\r\nBiquadFilterNode.prototype.updateData = function (data) {\r\n  this.type = data.type;\r\n  this.frequency.value = data.frequency;\r\n};\r\n\r\neditor.on(\"connectionCreated\", function (connection) {\r\n  console.log(\"Connection created\");\r\n  console.log(connection);\r\n\r\n  const sendingNode = audioNodes[connection.output_id];\r\n  const recievingNode = audioNodes[connection.input_id];\r\n  if (sendingNode && recievingNode) {\r\n    sendingNode.connect(recievingNode.getInput(connection.input_class));\r\n  }\r\n  saveData();\r\n});\r\n\r\neditor.on(\"connectionRemoved\", function (connection) {\r\n  console.log(\"Connection removed\");\r\n  console.log(connection);\r\n  audioNodes[connection.output_id]?.disconnect(\r\n    audioNodes[connection.input_id].getInput(connection.input_class)\r\n  );\r\n  saveData();\r\n});\r\n\r\neditor.on(\"mouseMove\", function (position) {\r\n  //console.log(\"Position mouse x:\" + position.x + \" y:\" + position.y);\r\n});\r\n\r\neditor.on(\"nodeDataChanged\", function (id) {\r\n  const { data } = editor.getNodeFromId(id);\r\n  console.log(data, audioNodes[id]);\r\n  audioNodes[id].updateData(data);\r\n  saveData();\r\n});\r\n\r\neditor.on(\"nodeMoved\", function (id) {\r\n  console.log(\"Node moved \" + id);\r\n});\r\n\r\neditor.on(\"zoom\", function (zoom) {\r\n  console.log(\"Zoom level \" + zoom);\r\n});\r\n\r\neditor.on(\"translate\", function (position) {\r\n  //console.log(\"Translate x:\" + position.x + \" y:\" + position.y);\r\n});\r\n\r\neditor.on(\"addReroute\", function (id) {\r\n  console.log(\"Reroute added \" + id);\r\n});\r\n\r\neditor.on(\"removeReroute\", function (id) {\r\n  console.log(\"Reroute removed \" + id);\r\n});\r\n\r\n/* DRAG EVENT */\r\n\r\n/* Mouse and Touch Actions */\r\n\r\nvar elements = document.getElementsByClassName(\"drag-drawflow\");\r\nfor (var i = 0; i < elements.length; i++) {\r\n  elements[i].addEventListener(\"touchend\", drop, false);\r\n  elements[i].addEventListener(\"touchmove\", positionMobile, false);\r\n  elements[i].addEventListener(\"touchstart\", drag, false);\r\n}\r\n\r\nvar mobile_item_selec = \"\";\r\nvar mobile_last_move = null;\r\nfunction positionMobile(ev) {\r\n  mobile_last_move = ev;\r\n}\r\n\r\nfunction allowDrop(ev) {\r\n  ev.preventDefault();\r\n}\r\n\r\nfunction drag(ev) {\r\n  if (ev.type === \"touchstart\") {\r\n    mobile_item_selec = ev.target\r\n      .closest(\".drag-drawflow\")\r\n      .getAttribute(\"data-node\");\r\n  } else {\r\n    ev.dataTransfer.setData(\"node\", ev.target.getAttribute(\"data-node\"));\r\n  }\r\n}\r\n\r\nfunction drop(ev) {\r\n  if (ev.type === \"touchend\") {\r\n    var parentdrawflow = document\r\n      .elementFromPoint(\r\n        mobile_last_move.touches[0].clientX,\r\n        mobile_last_move.touches[0].clientY\r\n      )\r\n      .closest(\"#drawflow\");\r\n    if (parentdrawflow != null) {\r\n      addNodeToDrawFlow(\r\n        mobile_item_selec,\r\n        mobile_last_move.touches[0].clientX,\r\n        mobile_last_move.touches[0].clientY\r\n      );\r\n    }\r\n    mobile_item_selec = \"\";\r\n  } else {\r\n    ev.preventDefault();\r\n    var data = ev.dataTransfer.getData(\"node\");\r\n    addNodeToDrawFlow(data, ev.clientX, ev.clientY);\r\n  }\r\n}\r\n\r\nfunction addNodeToDrawFlow(name, pos_x, pos_y) {\r\n  if (editor.editor_mode === \"fixed\") {\r\n    return false;\r\n  }\r\n  pos_x =\r\n    pos_x *\r\n      (editor.precanvas.clientWidth /\r\n        (editor.precanvas.clientWidth * editor.zoom)) -\r\n    editor.precanvas.getBoundingClientRect().x *\r\n      (editor.precanvas.clientWidth /\r\n        (editor.precanvas.clientWidth * editor.zoom));\r\n  pos_y =\r\n    pos_y *\r\n      (editor.precanvas.clientHeight /\r\n        (editor.precanvas.clientHeight * editor.zoom)) -\r\n    editor.precanvas.getBoundingClientRect().y *\r\n      (editor.precanvas.clientHeight /\r\n        (editor.precanvas.clientHeight * editor.zoom));\r\n  switch (name) {\r\n    case \"output\":\r\n      var output = `\r\n      <div>\r\n        <div class=\"title-box\"><i class=\"fas fa-at\"></i> Audio Out </div>\r\n      </div>\r\n      `;\r\n      editor.addNode(\"output\", 1, 0, pos_x, pos_y, \"output\", {}, output);\r\n      break;\r\n    case \"gain\":\r\n      var gain = `\r\n        <div>\r\n          <div class=\"title-box\"><i class=\"fas fa-at\"></i> Gain</div>\r\n      <div class=\"box\">\r\n        <p>Gain</p>\r\n        <input type=\"number\" df-gain>\r\n      </div>\r\n        </div>\r\n        `;\r\n      editor.addNode(\"gain\", 2, 1, pos_x, pos_y, \"gain\", { gain: 1 }, gain);\r\n      break;\r\n\r\n    case \"env\":\r\n      var env = `\r\n      <div>\r\n        <div class=\"title-box\"><i class=\"fab fa-telegram-plane\"></i> Envelope</div>\r\n        <div class=\"box\">\r\n          <p>Select type</p>\r\n          <select df-ramptype>\r\n            <option value=\"exp\">Exponential</option>\r\n            <option value=\"linear\">Linear</option>\r\n            <option value=\"instant\">Instant</option>\r\n          </select>\r\n        </div>\r\n        <div class=\"box\">\r\n          <p>Attack</p>\r\n          <input type=\"number\" df-attack>\r\n        </div>\r\n        <div class=\"box\">\r\n          <p>Decay</p>\r\n          <input type=\"number\" df-decay>\r\n        </div>\r\n        <div class=\"box\">\r\n          <p>Peak</p>\r\n          <input type=\"number\" df-peak>\r\n        </div>\r\n      </div>\r\n      `;\r\n      editor.addNode(\r\n        \"envelope\",\r\n        0,\r\n        1,\r\n        pos_x,\r\n        pos_y,\r\n        \"envelope\",\r\n        { ramptype: \"exp\", attack: 1, peak: 1, decay: 1 },\r\n        env\r\n      );\r\n      break;\r\n\r\n    case \"noise\":\r\n      var noise = `\r\n        <div>\r\n          <div class=\"title-box\"><i class=\"fab fa-telegram-plane\"></i> Noise</div>\r\n          <div class=\"box\">\r\n            <p>Select type</p>\r\n            <select df-type>\r\n              <option value=\"white\">White</option>\r\n              <option value=\"pink\">Pink</option>\r\n              <option value=\"brown\">Brown</option>\r\n            </select>\r\n          </div>\r\n        </div>\r\n        `;\r\n      editor.addNode(\r\n        \"noise\",\r\n        0,\r\n        1,\r\n        pos_x,\r\n        pos_y,\r\n        \"noise\",\r\n        { type: \"white\" },\r\n        noise\r\n      );\r\n      break;\r\n\r\n    case \"filter\":\r\n      var filter = `\r\n      <div>\r\n        <div class=\"title-box\"><i class=\"fab fa-telegram-plane\"></i> Filter</div>\r\n        <div class=\"box\">\r\n          <p>Select type</p>\r\n          <select df-type>\r\n            <option value=\"lowpass\">Low Pass</option>\r\n            <option value=\"highpass\">High Pass</option>\r\n            <option value=\"bandpass\">Band Pass</option>\r\n            <option value=\"lowshelf\">Low Shelf</option>\r\n            <option value=\"peaking\">Peaking</option>\r\n            <option value=\"notch\">Notch</option>\r\n            <option value=\"allpass\">All Pass</option>\r\n          </select>\r\n        </div>\r\n        <div class=\"box\">\r\n          <p>Frequency</p>\r\n          <input type=\"number\" df-frequency>\r\n        </div>\r\n      </div>\r\n      `;\r\n      editor.addNode(\r\n        \"filter\",\r\n        2,\r\n        1,\r\n        pos_x,\r\n        pos_y,\r\n        \"filter\",\r\n        { type: \"lowpass\", frequency: 200 },\r\n        filter\r\n      );\r\n      break;\r\n\r\n    case \"osc\":\r\n      var osc = `\r\n    <div>\r\n      <div class=\"title-box\"><i class=\"fab fa-telegram-plane\"></i> Oscillator</div>\r\n      <div class=\"box\">\r\n        <p>Select type</p>\r\n        <select df-type>\r\n          <option value=\"sine\">Sine</option>\r\n          <option value=\"square\">Square</option>\r\n          <option value=\"sawtooth\">Sawtooth</option>\r\n          <option value=\"triangle\">Triangle</option>\r\n        </select>\r\n      </div>\r\n      <div class=\"box\">\r\n        <p>Frequency</p>\r\n        <input type=\"number\" df-frequency>\r\n      </div>\r\n    </div>\r\n    `;\r\n      editor.addNode(\r\n        \"oscillator\",\r\n        1,\r\n        1,\r\n        pos_x,\r\n        pos_y,\r\n        \"oscillator\",\r\n        { type: \"sine\", frequency: 260 },\r\n        osc\r\n      );\r\n      break;\r\n    case \"facebook\":\r\n      var facebook = `\r\n  <div>\r\n    <div class=\"title-box\"><i class=\"fab fa-facebook\"></i> Facebook Message</div>\r\n  </div>\r\n  `;\r\n      editor.addNode(\"facebook\", 0, 1, pos_x, pos_y, \"facebook\", {}, facebook);\r\n      break;\r\n    case \"slack\":\r\n      var slackchat = `\r\n    <div>\r\n      <div class=\"title-box\"><i class=\"fab fa-slack\"></i> Slack chat message</div>\r\n    </div>\r\n    `;\r\n      editor.addNode(\"slack\", 1, 0, pos_x, pos_y, \"slack\", {}, slackchat);\r\n      break;\r\n    case \"github\":\r\n      var githubtemplate = `\r\n    <div>\r\n      <div class=\"title-box\"><i class=\"fab fa-github \"></i> Github Stars</div>\r\n      <div class=\"box\">\r\n        <p>Enter repository url</p>\r\n      <input type=\"text\" df-name>\r\n      </div>\r\n    </div>\r\n    `;\r\n      editor.addNode(\r\n        \"github\",\r\n        0,\r\n        1,\r\n        pos_x,\r\n        pos_y,\r\n        \"github\",\r\n        { name: \"\" },\r\n        githubtemplate\r\n      );\r\n      break;\r\n    case \"telegram\":\r\n      var telegrambot = `\r\n    <div>\r\n      <div class=\"title-box\"><i class=\"fab fa-telegram-plane\"></i> Telegram bot</div>\r\n      <div class=\"box\">\r\n        <p>Send to telegram</p>\r\n        <p>select channel</p>\r\n        <select df-channel>\r\n          <option value=\"channel_1\">Channel 1</option>\r\n          <option value=\"channel_2\">Channel 2</option>\r\n          <option value=\"channel_3\">Channel 3</option>\r\n          <option value=\"channel_4\">Channel 4</option>\r\n        </select>\r\n      </div>\r\n    </div>\r\n    `;\r\n      editor.addNode(\r\n        \"telegram\",\r\n        1,\r\n        0,\r\n        pos_x,\r\n        pos_y,\r\n        \"telegram\",\r\n        { channel: \"channel_3\" },\r\n        telegrambot\r\n      );\r\n      break;\r\n    case \"aws\":\r\n      var aws = `\r\n    <div>\r\n      <div class=\"title-box\"><i class=\"fab fa-aws\"></i> Aws Save </div>\r\n      <div class=\"box\">\r\n        <p>Save in aws</p>\r\n        <input type=\"text\" df-db-dbname placeholder=\"DB name\"><br><br>\r\n        <input type=\"text\" df-db-key placeholder=\"DB key\">\r\n        <p>Output Log</p>\r\n      </div>\r\n    </div>\r\n    `;\r\n      editor.addNode(\r\n        \"aws\",\r\n        1,\r\n        1,\r\n        pos_x,\r\n        pos_y,\r\n        \"aws\",\r\n        { db: { dbname: \"\", key: \"\" } },\r\n        aws\r\n      );\r\n      break;\r\n    case \"log\":\r\n      var log = `\r\n      <div>\r\n        <div class=\"title-box\"><i class=\"fas fa-file-signature\"></i> Save log file </div>\r\n      </div>\r\n      `;\r\n      editor.addNode(\"log\", 1, 0, pos_x, pos_y, \"log\", {}, log);\r\n      break;\r\n    case \"google\":\r\n      var google = `\r\n      <div>\r\n        <div class=\"title-box\"><i class=\"fab fa-google-drive\"></i> Google Drive save </div>\r\n      </div>\r\n      `;\r\n      editor.addNode(\"google\", 1, 0, pos_x, pos_y, \"google\", {}, google);\r\n      break;\r\n    case \"email\":\r\n      var email = `\r\n      <div>\r\n        <div class=\"title-box\"><i class=\"fas fa-at\"></i> Send Email </div>\r\n      </div>\r\n      `;\r\n      editor.addNode(\"email\", 1, 0, pos_x, pos_y, \"email\", {}, email);\r\n      break;\r\n\r\n    case \"template\":\r\n      var template = `\r\n      <div>\r\n        <div class=\"title-box\"><i class=\"fas fa-code\"></i> Template</div>\r\n        <div class=\"box\">\r\n          Ger Vars\r\n          <textarea df-template></textarea>\r\n          Output template with vars\r\n        </div>\r\n      </div>\r\n      `;\r\n      editor.addNode(\r\n        \"template\",\r\n        1,\r\n        1,\r\n        pos_x,\r\n        pos_y,\r\n        \"template\",\r\n        { template: \"Write your template\" },\r\n        template\r\n      );\r\n      break;\r\n    case \"multiple\":\r\n      var multiple = `\r\n      <div>\r\n        <div class=\"box\">\r\n          Multiple!\r\n        </div>\r\n      </div>\r\n      `;\r\n      editor.addNode(\"multiple\", 3, 4, pos_x, pos_y, \"multiple\", {}, multiple);\r\n      break;\r\n    case \"personalized\":\r\n      var personalized = `\r\n      <div>\r\n        Personalized\r\n      </div>\r\n      `;\r\n      editor.addNode(\r\n        \"personalized\",\r\n        1,\r\n        1,\r\n        pos_x,\r\n        pos_y,\r\n        \"personalized\",\r\n        {},\r\n        personalized\r\n      );\r\n      break;\r\n    case \"dbclick\":\r\n      var dbclick = `\r\n      <div>\r\n      <div class=\"title-box\"><i class=\"fas fa-mouse\"></i> Db Click</div>\r\n        <div class=\"box dbclickbox\" ondblclick=\"showpopup(event)\">\r\n          Db Click here\r\n          <div class=\"modal\" style=\"display:none\">\r\n            <div class=\"modal-content\">\r\n              <span class=\"close\" onclick=\"closemodal(event)\">&times;</span>\r\n              Change your variable {name} !\r\n              <input type=\"text\" df-name>\r\n            </div>\r\n\r\n          </div>\r\n        </div>\r\n      </div>\r\n      `;\r\n      editor.addNode(\r\n        \"dbclick\",\r\n        1,\r\n        1,\r\n        pos_x,\r\n        pos_y,\r\n        \"dbclick\",\r\n        { name: \"\" },\r\n        dbclick\r\n      );\r\n      break;\r\n\r\n    default:\r\n  }\r\n}\r\n\r\nvar transform = \"\";\r\nfunction showpopup(e) {\r\n  e.target.closest(\".drawflow-node\").style.zIndex = \"9999\";\r\n  e.target.children[0].style.display = \"block\";\r\n  //document.getElementById(\"modalfix\").style.display = \"block\";\r\n\r\n  //e.target.children[0].style.transform = 'translate('+translate.x+'px, '+translate.y+'px)';\r\n  transform = editor.precanvas.style.transform;\r\n  editor.precanvas.style.transform = \"\";\r\n  editor.precanvas.style.left = editor.canvas_x + \"px\";\r\n  editor.precanvas.style.top = editor.canvas_y + \"px\";\r\n  console.log(transform);\r\n\r\n  //e.target.children[0].style.top  =  -editor.canvas_y - editor.container.offsetTop +'px';\r\n  //e.target.children[0].style.left  =  -editor.canvas_x  - editor.container.offsetLeft +'px';\r\n  editor.editor_mode = \"fixed\";\r\n}\r\n\r\nfunction closemodal(e) {\r\n  e.target.closest(\".drawflow-node\").style.zIndex = \"2\";\r\n  e.target.parentElement.parentElement.style.display = \"none\";\r\n  //document.getElementById(\"modalfix\").style.display = \"none\";\r\n  editor.precanvas.style.transform = transform;\r\n  editor.precanvas.style.left = \"0px\";\r\n  editor.precanvas.style.top = \"0px\";\r\n  editor.editor_mode = \"edit\";\r\n}\r\n\r\nfunction changeModule(event) {\r\n  var all = document.querySelectorAll(\".menu ul li\");\r\n  for (var i = 0; i < all.length; i++) {\r\n    all[i].classList.remove(\"selected\");\r\n  }\r\n  event.target.classList.add(\"selected\");\r\n}\r\n\r\nfunction changeMode(option) {\r\n  //console.log(lock.id);\r\n  if (option == \"lock\") {\r\n    lock.style.display = \"none\";\r\n    unlock.style.display = \"block\";\r\n  } else {\r\n    lock.style.display = \"block\";\r\n    unlock.style.display = \"none\";\r\n  }\r\n}\r\n\r\nfunction trigger() {\r\n  for (const [_, audioNode] of Object.entries(audioNodes)) {\r\n    console.log(audioNode);\r\n    if (audioNode.applyEnvelope) {\r\n      audioNode.applyEnvelope();\r\n    }\r\n  }\r\n}\r\n\r\nwindow.drop = drop;\r\nwindow.drag = drag;\r\nwindow.allowDrop = allowDrop;\r\nwindow.editor = editor;\r\nwindow.trigger = trigger;\r\n\r\nreadData();\r\nrequestAnimationFrame(draw);\r\n"],"names":["id","editor","audioContext","audioNodes","stateString","compress","str","compressedStream","chunks","chunk","concatUint8Arrays","decompress","compressedBytes","decompressedStream","stringBytes","uint8arrays","buffer","encodeToUrl","data","dataString","uint8Array","base64UrlSafe","url","decodeFromUrl","base64","char","readData","state","connectionsMap","idMap","_","value","name","html","inputs","outputs","pos_x","pos_y","newId","outputName","i","connections","connectionList","node","output","saveData","exportdata","draw","timestamp","audioNode","canvas","analyser","canvasCtx","bufferLength","dataArray","windowSize","time","bufferTimeLength","sampleTick","x","j","y","_b","_a","Envelope","NoiseNode","htmlBody","bufferSize","noiseBuffer","b0","b1","b2","b3","b4","b5","b6","white","lastOut","key","setValue","currentTime","val","t","addStep","deltaTime","connection","sendingNode","recievingNode","position","zoom","elements","drop","positionMobile","drag","mobile_item_selec","mobile_last_move","ev","allowDrop","parentdrawflow","addNodeToDrawFlow","gain","env","noise","filter","osc","facebook","slackchat","githubtemplate","telegrambot","aws","log","google","email","template","multiple","personalized","dbclick","trigger"],"mappings":"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"}